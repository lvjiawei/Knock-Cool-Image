<?php/* * user.php * update or insert the imformation of user * @package: Knock-Cool-Image/lib/action * @author zhuhaofeng * @version 0.1 * @copyright 2010 * @access public */require(realpath("./")."/lib/MySQL.php");//require_once(realpath("./")."/lib/actions/email.php");class user{	private $row;	private $temp=array(		1 => '',		2 => '',		3 => '',		4 => '',		5 => ''//		'birthday' => '',//		'right' => '',//      'avatar' => '',	);	private $info=array(		1 => 'e_mail',		2 => 'password',		3 => 'nickname',		4 => 'pwquestion',		5 => 'pwanswer'//		'birthday' => '',//		'right' => '',//      'avatar' => '',	);	private $sql;//	private $avatar;	private $action;	function __construct($param)	{		$this->action=$param;		if($this->action==1)		{			//mysql_select_db("user_db");			//$sql=$mysql->getConnect();			$this->sql=connect();			$db=mysql_select_db("user_db",$this->sql);			$result=mysql_query("select * from userinfo where uid=".$_SESSION['user']."",$this->sql);			$this->row=mysql_fetch_array($result);			if($this->row){				return true;			}else				return false;		}else{			$this->sql=new MySQL();			//mysql_select_db("user_db");			//$sql=$mysql->getConnect();			//$this->sql=$mysql;			if($this->sql){				return true;			}			else				return false;		}	}	function __destrcut()	{		if(isset ($this->temp))			unset ($this->temp);		if(isset ($this->info))			unset ($this->info);		if(isset ($this->sql))			unset ($this->sql);/*		if(isset ($this->avatar))			unset ($this->avatar);		if(isset ($this->birthday))			unset ($this->birthday);		if(isset ($this->right))			unset ($this->right);		if(isset ($this->action))			unset ($this->action);*/	}	public function setEmail($param)	{		$this->temp[1]=$param;	}	public function setPassword($param)	{		$this->temp[2]=$param;	}	public function setPwanswer($param)	{		$this->temp[5]=$param;	}	public function setPwquestion($param)	{		$this->temp[4]=$param;	}	public function setNickname($param)	{		$this->temp[3]=$param;	}/*	public function setBirthday($param)	{		$this->birthday=$param;	}	public function setRight($param)	{		$this->right=$param;	}	public function setAvatar($param)	{		$this->avatar=$param;	}*//*	public function update()	{		if($this->action==1){			for($i=1;$i<6;$i++){				if($temp[''.$i.'']!=""){					$sql->setUpdate("userinfo","".$info[''.$i.'']."=".$temp[''.$i.'']."","uid=".$this->row['uid']."");					$tem=$sql->update();				}			}			return true;		}		else			return false;	}*/	public function signup($param)	{	//	$mysql=mysql_connect("localhost","root","");if(!$mysql)die('Could not connect: ' . mysql_error());//		$db=mysql_select_db("user_db");if(!$db)die('Could not connect: ' . mysql_error());		//$sql=$mysql->getConnect();		if($this->action==2){/*			$mysql=$this->sql;			$mysql->setAdd("userinfo","e_mail,password,nickname,pwquestion,pwanswer",$param);			return $mysql->query();*/			$this->sql->setAdd("userinfo","e_mail,password,nickname,pwquestion,pwanswer",$param);			return $this->sql->add();		}		return false;	}	public function changetap($param){		//$this->sql->mysql_select_db('user_db');		return mysql_query("update userinfo set tap=".$param." where uid=".$_SESSION['user']."",$this->sql);	}	public function changeavatar($param){		return mysql_query("update userinfo set avatar=".$param." where uid=".$_SESSION['user']."",$this->sql);	}	public function changename($param){		return mysql_query("update userinfo set nickname=''".$param."' where uid=".$_SESSION['user']."",$this->sql);	}	public function changeymd($param)	{		return mysql_query("update userinfo set ymd=".$param." where uid=".$_SESSION['user']."",$this->sql);	}	public function changeps($param1,$param2){		if($this->row['password']==$param1){			return mysql_query("update userinfo set password=".$param2." where uid=".$_SESSION['user']."",$this->sql);		}else			return false;	}	public function userexist($param)	{		//$mysql=mysql_connect("localhost","root","");if(!$mysql)die('Could not connect: ' . mysql_error());		//$db=mysql_select_db("user_db");if(!$db)die('Could not connect: ' . mysql_error());		//$sql=$mysql->getConnect();		//$result=mysql_query("select * from userinfo where e_mail='".$param."'",$mysql);if(!$result)die('Could not connect: ' . mysql_error());	//	if($result){		//	$num=mysql_num_rows($result);		//	if($num==0)		//		return true;		//	else		//		return false;//		}		//$mysql=$this->sql;		$this->sql->setSelect("*","userinfo","e_mail=".$param."");		return $this->sql->select();	}}?>